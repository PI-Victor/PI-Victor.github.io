<!DOCTYPE html>
<html lang="en">
<head>
  
    <title>Make your life with gRPC easier :: Software and Ops</title>
  
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="Earlier this year i started to write a lot of gRPC services and after a while fiddling around, there are things that are wroth mentioning for the uninitiated.
Design documentation I found the Google API design documentation useful for making you adopt some standards for your API early on. You don&amp;rsquo;t have to follow it word by word, but overall it definitely has its use. From mapping http methods to gRPC methods to naming conventions that help you design your API intuitive for future growth." />
<meta name="keywords" content="" />
<meta name="robots" content="noodp" />
<link rel="canonical" href="http://victor.cloudflavor.io/2020/12/make-your-life-with-grpc-easier/" />




<link rel="stylesheet" href="http://victor.cloudflavor.io/assets/style.css">

  <link rel="stylesheet" href="assets/%25!s%28%3cnil%3e%29.css">






<link rel="apple-touch-icon" href="http://victor.cloudflavor.io/img/apple-touch-icon-192x192.png">

  <link rel="shortcut icon" href="http://victor.cloudflavor.io/img/favicon/orange.png">



<meta name="twitter:card" content="summary" />



<meta property="og:locale" content="en" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Make your life with gRPC easier">
<meta property="og:description" content="Earlier this year i started to write a lot of gRPC services and after a while fiddling around, there are things that are wroth mentioning for the uninitiated.
Design documentation I found the Google API design documentation useful for making you adopt some standards for your API early on. You don&amp;rsquo;t have to follow it word by word, but overall it definitely has its use. From mapping http methods to gRPC methods to naming conventions that help you design your API intuitive for future growth." />
<meta property="og:url" content="http://victor.cloudflavor.io/2020/12/make-your-life-with-grpc-easier/" />
<meta property="og:site_name" content="Software and Ops" />

  
    <meta property="og:image" content="img/favicon/%!s().png">
  

<meta property="og:image:width" content="2048">
<meta property="og:image:height" content="1024">


  <meta property="article:published_time" content="2020-12-13 05:02:27 &#43;0100 CET" />












</head>
<body class="">


<div class="container center headings--one-size">

  <header class="header">
  <div class="header__inner">
    <div class="header__logo">
      <a href="http://victor.cloudflavor.io/">
  <div class="logo">
    Cloudflavor
  </div>
</a>

    </div>
    
      <div class="menu-trigger">menu</div>
    
  </div>
  
    <nav class="menu">
  <ul class="menu__inner menu__inner--desktop">
    
      
        
          <li><a href="/about">about</a></li>
        
      
        
          <li><a href="/posts">blog</a></li>
        
      
        
          <li><a href="https://github.com/pi-victor">github</a></li>
        
      
    

    
  </ul>

  <ul class="menu__inner menu__inner--mobile">
    
      
        <li><a href="/about">about</a></li>
      
    
      
        <li><a href="/posts">blog</a></li>
      
    
      
        <li><a href="https://github.com/pi-victor">github</a></li>
      
    
    
  </ul>
</nav>

  
</header>


  <div class="content">
    
<div class="post">
  <h1 class="post-title">
    <a href="http://victor.cloudflavor.io/2020/12/make-your-life-with-grpc-easier/">Make your life with gRPC easier</a></h1>
  <div class="post-meta">
    
      <span class="post-date">
        2020-12-13 
      </span>
    
    
    <span class="post-author">:: PI-Victor</span>
    
  </div>

  
  <span class="post-tags">
    
    #<a href="http://victor.cloudflavor.io/tags/grpc/">grpc</a>&nbsp;
    
    #<a href="http://victor.cloudflavor.io/tags/go/">go</a>&nbsp;
    
    #<a href="http://victor.cloudflavor.io/tags/protobuf/">protobuf</a>&nbsp;
    
    #<a href="http://victor.cloudflavor.io/tags/reflection/">reflection</a>&nbsp;
    
    #<a href="http://victor.cloudflavor.io/tags/grpcurl/">grpcurl</a>&nbsp;
    
    #<a href="http://victor.cloudflavor.io/tags/debugging/">debugging</a>&nbsp;
    
    #<a href="http://victor.cloudflavor.io/tags/tips/">tips</a>&nbsp;
    
  </span>
  

  

  

  <div class="post-content"><div>
        <p>Earlier this year i started to write a lot of gRPC services and after a while fiddling around, there
are things that are wroth mentioning for the uninitiated.</p>
<h3 id="design-documentation">Design documentation<a href="#design-documentation" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<p>I found the <a href="https://cloud.google.com/apis/design">Google API design documentation</a> useful for making you
adopt some standards for your API early on. You don&rsquo;t have to follow it word by word, but overall it
definitely has its use. From <a href="https://cloud.google.com/apis/design/standard_methods">mapping http methods to gRPC methods</a>
to <a href="https://cloud.google.com/apis/design/naming_convention">naming conventions</a> that help you design your
API intuitive for future growth.</p>
<h3 id="exploring-grpc-apis-at-runtime">Exploring gRPC APIs at runtime<a href="#exploring-grpc-apis-at-runtime" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<p>You can explore gRPC APIs at runtime by using <a href="https://github.com/fullstorydev/grpcurl">grpcurl</a>.
grpcurl is not only able to behave like regular curl but it can also be used to explore your API, this can
be achieved in two ways:</p>
<ul>
<li>enable reflection in your go code</li>
<li>passing the protoset source file as a parameter</li>
<li>passing the protoset compiled bin file</li>
</ul>
<h4 id="enabling-and-exploring-with-reflection">Enabling and exploring with reflection<a href="#enabling-and-exploring-with-reflection" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h4>
<p>Given the following protobuf API:</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="0"><a style="outline: none; text-decoration:none; color:inherit" href="#0">0</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="1"><a style="outline: none; text-decoration:none; color:inherit" href="#1">1</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="2"><a style="outline: none; text-decoration:none; color:inherit" href="#2">2</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="3"><a style="outline: none; text-decoration:none; color:inherit" href="#3">3</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="4"><a style="outline: none; text-decoration:none; color:inherit" href="#4">4</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="5"><a style="outline: none; text-decoration:none; color:inherit" href="#5">5</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="6"><a style="outline: none; text-decoration:none; color:inherit" href="#6">6</a>
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-proto" data-lang="proto"><span style="color:#8be9fd;font-style:italic">service</span> StorageApiService {
    <span style="color:#ff79c6">rpc</span> GetBuckets(GetBucketsRequest) <span style="color:#ff79c6">returns</span> (GetBucketsResponse) {}
    <span style="color:#8be9fd;font-style:italic">message</span> <span style="color:#50fa7b">GetBucketRequest</span> {}
    <span style="color:#8be9fd;font-style:italic">message</span> <span style="color:#50fa7b">GetBucketsResponse</span> {
        <span style="color:#ff79c6">repeated</span> Bucket buckets <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">1</span>;
    }
}
</code></pre></td></tr></table>
</div>
</div><p>Import reflection and register the gRPC server instance.</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="0"><a style="outline: none; text-decoration:none; color:inherit" href="#0"> 0</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="1"><a style="outline: none; text-decoration:none; color:inherit" href="#1"> 1</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="2"><a style="outline: none; text-decoration:none; color:inherit" href="#2"> 2</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="3"><a style="outline: none; text-decoration:none; color:inherit" href="#3"> 3</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="4"><a style="outline: none; text-decoration:none; color:inherit" href="#4"> 4</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="5"><a style="outline: none; text-decoration:none; color:inherit" href="#5"> 5</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="6"><a style="outline: none; text-decoration:none; color:inherit" href="#6"> 6</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="7"><a style="outline: none; text-decoration:none; color:inherit" href="#7"> 7</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="8"><a style="outline: none; text-decoration:none; color:inherit" href="#8"> 8</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="9"><a style="outline: none; text-decoration:none; color:inherit" href="#9"> 9</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="10"><a style="outline: none; text-decoration:none; color:inherit" href="#10">10</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="11"><a style="outline: none; text-decoration:none; color:inherit" href="#11">11</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="12"><a style="outline: none; text-decoration:none; color:inherit" href="#12">12</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="13"><a style="outline: none; text-decoration:none; color:inherit" href="#13">13</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="14"><a style="outline: none; text-decoration:none; color:inherit" href="#14">14</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="15"><a style="outline: none; text-decoration:none; color:inherit" href="#15">15</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="16"><a style="outline: none; text-decoration:none; color:inherit" href="#16">16</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="17"><a style="outline: none; text-decoration:none; color:inherit" href="#17">17</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="18"><a style="outline: none; text-decoration:none; color:inherit" href="#18">18</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="19"><a style="outline: none; text-decoration:none; color:inherit" href="#19">19</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="20"><a style="outline: none; text-decoration:none; color:inherit" href="#20">20</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="21"><a style="outline: none; text-decoration:none; color:inherit" href="#21">21</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="22"><a style="outline: none; text-decoration:none; color:inherit" href="#22">22</a>
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#ff79c6">import</span> (
    <span style="color:#f1fa8c">&#34;net&#34;</span>
    
    <span style="color:#f1fa8c">&#34;google.golang.org/grpc/reflection&#34;</span>
    <span style="color:#f1fa8c">&#34;google.golang.org/grpc&#34;</span>
)

<span style="color:#8be9fd;font-style:italic">func</span> <span style="color:#50fa7b">main</span>() {
    <span style="color:#ff79c6">...</span>
    lis, err <span style="color:#ff79c6">:=</span> net.<span style="color:#50fa7b">Listen</span>(<span style="color:#f1fa8c">&#34;tcp&#34;</span>, <span style="color:#f1fa8c">&#34;0.0.0.0:8099&#34;</span>)
    <span style="color:#ff79c6">if</span> err <span style="color:#ff79c6">!=</span> <span style="color:#ff79c6">nil</span> {
        <span style="color:#8be9fd;font-style:italic">panic</span>(err)
    }
    <span style="color:#ff79c6">defer</span> lis.<span style="color:#50fa7b">Close</span>()
    <span style="color:#8be9fd;font-style:italic">var</span> opts []grpc.ServerOption
    grpcServer <span style="color:#ff79c6">:=</span> grpc.<span style="color:#50fa7b">NewServer</span>(opts<span style="color:#ff79c6">...</span>)
    <span style="color:#6272a4">// register your gRPC implementation first
</span><span style="color:#6272a4"></span>    pbv1.<span style="color:#50fa7b">RegisterStorageApiService</span>(grpcServer, <span style="color:#50fa7b">newServer</span>())
    <span style="color:#6272a4">// enable reflection 
</span><span style="color:#6272a4"></span>    reflection.<span style="color:#50fa7b">Register</span>(grpcServer)
    grpcServer.<span style="color:#50fa7b">Serve</span>(list)
    <span style="color:#ff79c6">...</span>
}
</code></pre></td></tr></table>
</div>
</div><p>Assuming that the server is running on &ldquo;tcp://localhost:8099&rdquo;,
you can now explore the API by using <code>list</code> and <code>describe</code>.</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="0"><a style="outline: none; text-decoration:none; color:inherit" href="#0"> 0</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="1"><a style="outline: none; text-decoration:none; color:inherit" href="#1"> 1</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="2"><a style="outline: none; text-decoration:none; color:inherit" href="#2"> 2</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="3"><a style="outline: none; text-decoration:none; color:inherit" href="#3"> 3</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="4"><a style="outline: none; text-decoration:none; color:inherit" href="#4"> 4</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="5"><a style="outline: none; text-decoration:none; color:inherit" href="#5"> 5</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="6"><a style="outline: none; text-decoration:none; color:inherit" href="#6"> 6</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="7"><a style="outline: none; text-decoration:none; color:inherit" href="#7"> 7</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="8"><a style="outline: none; text-decoration:none; color:inherit" href="#8"> 8</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="9"><a style="outline: none; text-decoration:none; color:inherit" href="#9"> 9</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="10"><a style="outline: none; text-decoration:none; color:inherit" href="#10">10</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="11"><a style="outline: none; text-decoration:none; color:inherit" href="#11">11</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="12"><a style="outline: none; text-decoration:none; color:inherit" href="#12">12</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="13"><a style="outline: none; text-decoration:none; color:inherit" href="#13">13</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="14"><a style="outline: none; text-decoration:none; color:inherit" href="#14">14</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="15"><a style="outline: none; text-decoration:none; color:inherit" href="#15">15</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="16"><a style="outline: none; text-decoration:none; color:inherit" href="#16">16</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="17"><a style="outline: none; text-decoration:none; color:inherit" href="#17">17</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="18"><a style="outline: none; text-decoration:none; color:inherit" href="#18">18</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="19"><a style="outline: none; text-decoration:none; color:inherit" href="#19">19</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="20"><a style="outline: none; text-decoration:none; color:inherit" href="#20">20</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="21"><a style="outline: none; text-decoration:none; color:inherit" href="#21">21</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="22"><a style="outline: none; text-decoration:none; color:inherit" href="#22">22</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="23"><a style="outline: none; text-decoration:none; color:inherit" href="#23">23</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="24"><a style="outline: none; text-decoration:none; color:inherit" href="#24">24</a>
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ grpcurl --plaintext localhost:8099 list
codeflavor.grpcrest.proto.v1.StorageApiService
grpc.reflection.v1alpha.ServerReflection

$ grpcurl --plaintext localhost:8099 describe codeflavor.grpcrest.proto.v1.StorageApiService
codeflavor.grpcrest.proto.v1.StorageApiService is a service:
service StorageApiService <span style="color:#ff79c6">{</span>
  rpc GetBuckets <span style="color:#ff79c6">(</span> .codeflavor.grpcrest.proto.v1.GetBucketsRequest <span style="color:#ff79c6">)</span> returns <span style="color:#ff79c6">(</span> .codeflavor.grpcrest.proto.v1.GetBucketsResponse <span style="color:#ff79c6">)</span> <span style="color:#ff79c6">{}</span>
<span style="color:#ff79c6">}</span>

$ grpcurl --plaintext localhost:8099 describe codeflavor.grpcrest.proto.v1.StorageApiService.GetBuckets
codeflavor.grpcrest.proto.v1.StorageApiService.GetBuckets is a method:
rpc GetBuckets <span style="color:#ff79c6">(</span> .codeflavor.grpcrest.proto.v1.GetBucketsRequest <span style="color:#ff79c6">)</span> returns <span style="color:#ff79c6">(</span> .codeflavor.grpcrest.proto.v1.GetBucketsResponse <span style="color:#ff79c6">)</span> <span style="color:#ff79c6">{}</span>

$ grpcurl --plaintext localhost:8099 codeflavor.grpcrest.proto.v1.StorageApiService.GetBuckets
<span style="color:#ff79c6">{</span>
  <span style="color:#f1fa8c">&#34;buckets&#34;</span>: <span style="color:#ff79c6">[</span>
    <span style="color:#ff79c6">{</span>
      <span style="color:#f1fa8c">&#34;name&#34;</span>: <span style="color:#f1fa8c">&#34;bucket1&#34;</span>
    <span style="color:#ff79c6">}</span>,
    <span style="color:#ff79c6">{</span>
      <span style="color:#f1fa8c">&#34;name&#34;</span>: <span style="color:#f1fa8c">&#34;bucket2&#34;</span>
    <span style="color:#ff79c6">}</span>
  <span style="color:#ff79c6">]</span>
<span style="color:#ff79c6">}</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="exploring-using-the-protoset-source-file">Exploring using the protoset source file<a href="#exploring-using-the-protoset-source-file" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h4>
<p>In certaing situations you might not want to make the API publicly available, epsecially on the internet.
This type of information exposed can become a security concern and might expose information that should
not be publicly available.</p>
<p>Without reflection enable, we&rsquo;re unable to browse the API like we did above.</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="0"><a style="outline: none; text-decoration:none; color:inherit" href="#0">0</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="1"><a style="outline: none; text-decoration:none; color:inherit" href="#1">1</a>
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ grpcurl --plaintext localhost:8099 list
Failed to list services: server does not support the reflection API
</code></pre></td></tr></table>
</div>
</div><p>However we can pass the protoset source file:</p>
<p><strong>NOTE</strong>: If you import special proto files, like i do below, the paths need to be passed to <code>grpcurl</code>. In
my example i use the <code>grpc-gateway</code> annotations file (which i&rsquo;ll write a post about soon, ignore the
<code>option</code> entry for now).</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="0"><a style="outline: none; text-decoration:none; color:inherit" href="#0"> 0</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="1"><a style="outline: none; text-decoration:none; color:inherit" href="#1"> 1</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="2"><a style="outline: none; text-decoration:none; color:inherit" href="#2"> 2</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="3"><a style="outline: none; text-decoration:none; color:inherit" href="#3"> 3</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="4"><a style="outline: none; text-decoration:none; color:inherit" href="#4"> 4</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="5"><a style="outline: none; text-decoration:none; color:inherit" href="#5"> 5</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="6"><a style="outline: none; text-decoration:none; color:inherit" href="#6"> 6</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="7"><a style="outline: none; text-decoration:none; color:inherit" href="#7"> 7</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="8"><a style="outline: none; text-decoration:none; color:inherit" href="#8"> 8</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="9"><a style="outline: none; text-decoration:none; color:inherit" href="#9"> 9</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="10"><a style="outline: none; text-decoration:none; color:inherit" href="#10">10</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="11"><a style="outline: none; text-decoration:none; color:inherit" href="#11">11</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="12"><a style="outline: none; text-decoration:none; color:inherit" href="#12">12</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="13"><a style="outline: none; text-decoration:none; color:inherit" href="#13">13</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="14"><a style="outline: none; text-decoration:none; color:inherit" href="#14">14</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="15"><a style="outline: none; text-decoration:none; color:inherit" href="#15">15</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="16"><a style="outline: none; text-decoration:none; color:inherit" href="#16">16</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="17"><a style="outline: none; text-decoration:none; color:inherit" href="#17">17</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="18"><a style="outline: none; text-decoration:none; color:inherit" href="#18">18</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="19"><a style="outline: none; text-decoration:none; color:inherit" href="#19">19</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="20"><a style="outline: none; text-decoration:none; color:inherit" href="#20">20</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="21"><a style="outline: none; text-decoration:none; color:inherit" href="#21">21</a>
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">grpcurl --plaintext -import-path internal -import-path /usr/local/include/ -proto proto/grpcrest.proto localhost:8099 list
codeflavor.grpcrest.proto.v1.StorageApiService

grpcurl --plaintext -import-path internal -import-path /usr/local/include -proto proto/grpcrest.proto localhost:8099 describe
codeflavor.grpcrest.proto.v1.StorageApiService is a service:
service StorageApiService <span style="color:#ff79c6">{</span>
  rpc CreateBucket <span style="color:#ff79c6">(</span> .codeflavor.grpcrest.proto.v1.CreateBucketRequest <span style="color:#ff79c6">)</span> returns <span style="color:#ff79c6">(</span> .codeflavor.grpcrest.proto.v1.CreateBucketResponse <span style="color:#ff79c6">)</span> <span style="color:#ff79c6">{</span>
    option <span style="color:#ff79c6">(</span>.google.api.http<span style="color:#ff79c6">)</span> <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">{</span> post:<span style="color:#f1fa8c">&#34;/v1/buckets&#34;</span> body:<span style="color:#f1fa8c">&#34;*&#34;</span> response_body:<span style="color:#f1fa8c">&#34;bucket&#34;</span>  <span style="color:#ff79c6">}</span>;
  <span style="color:#ff79c6">}</span>
  rpc GetBuckets <span style="color:#ff79c6">(</span> .codeflavor.grpcrest.proto.v1.GetBucketsRequest <span style="color:#ff79c6">)</span> returns <span style="color:#ff79c6">(</span> .codeflavor.grpcrest.proto.v1.GetBucketsResponse <span style="color:#ff79c6">)</span> <span style="color:#ff79c6">{</span>
    option <span style="color:#ff79c6">(</span>.google.api.http<span style="color:#ff79c6">)</span> <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">{</span> get:<span style="color:#f1fa8c">&#34;/v1/buckets&#34;</span>  <span style="color:#ff79c6">}</span>;
  <span style="color:#ff79c6">}</span>
  rpc GetObject <span style="color:#ff79c6">(</span> .codeflavor.grpcrest.proto.v1.GetObjectRequest <span style="color:#ff79c6">)</span> returns <span style="color:#ff79c6">(</span> .codeflavor.grpcrest.proto.v1.GetObjectResponse <span style="color:#ff79c6">)</span> <span style="color:#ff79c6">{</span>
    option <span style="color:#ff79c6">(</span>.google.api.http<span style="color:#ff79c6">)</span> <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">{</span> get:<span style="color:#f1fa8c">&#34;/v1/buckets/{bucket}/objects/*&#34;</span>  <span style="color:#ff79c6">}</span>;
  <span style="color:#ff79c6">}</span>
  rpc GetObjects <span style="color:#ff79c6">(</span> .codeflavor.grpcrest.proto.v1.GetObjectsRequest <span style="color:#ff79c6">)</span> returns <span style="color:#ff79c6">(</span> .codeflavor.grpcrest.proto.v1.GetObjectsResponse <span style="color:#ff79c6">)</span> <span style="color:#ff79c6">{</span>
    option <span style="color:#ff79c6">(</span>.google.api.http<span style="color:#ff79c6">)</span> <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">{</span> get:<span style="color:#f1fa8c">&#34;/v1/buckets/{bucket}/objects&#34;</span>  <span style="color:#ff79c6">}</span>;
  <span style="color:#ff79c6">}</span>
  rpc GetResult <span style="color:#ff79c6">(</span> .codeflavor.grpcrest.proto.v1.GetResultRequest <span style="color:#ff79c6">)</span> returns <span style="color:#ff79c6">(</span> stream .codeflavor.grpcrest.proto.v1.GetResultResponse <span style="color:#ff79c6">)</span> <span style="color:#ff79c6">{</span>
    option <span style="color:#ff79c6">(</span>.google.api.http<span style="color:#ff79c6">)</span> <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">{</span> get:<span style="color:#f1fa8c">&#34;/v1/results&#34;</span>  <span style="color:#ff79c6">}</span>;
  <span style="color:#ff79c6">}</span>
<span style="color:#ff79c6">}</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="exploring-using-the-compiled-protoset-bin-file">Exploring using the compiled protoset bin file<a href="#exploring-using-the-compiled-protoset-bin-file" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h4>
<p>Alternatively you can pass the compiled protoset binary file.</p>
<p>Compile the protoset bin file:</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="0"><a style="outline: none; text-decoration:none; color:inherit" href="#0">0</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="1"><a style="outline: none; text-decoration:none; color:inherit" href="#1">1</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="2"><a style="outline: none; text-decoration:none; color:inherit" href="#2">2</a>
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ protoc --proto_path<span style="color:#ff79c6">=</span>. <span style="color:#f1fa8c">\
</span><span style="color:#f1fa8c"></span>    --descriptor_set_out<span style="color:#ff79c6">=</span>StorageApiService.protoset <span style="color:#f1fa8c">\
</span><span style="color:#f1fa8c"></span>    --include_imports internal/proto/grpcrest.proto
</code></pre></td></tr></table>
</div>
</div><p>Use the protoset bin file to describe the API</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="0"><a style="outline: none; text-decoration:none; color:inherit" href="#0"> 0</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="1"><a style="outline: none; text-decoration:none; color:inherit" href="#1"> 1</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="2"><a style="outline: none; text-decoration:none; color:inherit" href="#2"> 2</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="3"><a style="outline: none; text-decoration:none; color:inherit" href="#3"> 3</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="4"><a style="outline: none; text-decoration:none; color:inherit" href="#4"> 4</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="5"><a style="outline: none; text-decoration:none; color:inherit" href="#5"> 5</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="6"><a style="outline: none; text-decoration:none; color:inherit" href="#6"> 6</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="7"><a style="outline: none; text-decoration:none; color:inherit" href="#7"> 7</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="8"><a style="outline: none; text-decoration:none; color:inherit" href="#8"> 8</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="9"><a style="outline: none; text-decoration:none; color:inherit" href="#9"> 9</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="10"><a style="outline: none; text-decoration:none; color:inherit" href="#10">10</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="11"><a style="outline: none; text-decoration:none; color:inherit" href="#11">11</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="12"><a style="outline: none; text-decoration:none; color:inherit" href="#12">12</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="13"><a style="outline: none; text-decoration:none; color:inherit" href="#13">13</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="14"><a style="outline: none; text-decoration:none; color:inherit" href="#14">14</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="15"><a style="outline: none; text-decoration:none; color:inherit" href="#15">15</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="16"><a style="outline: none; text-decoration:none; color:inherit" href="#16">16</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="17"><a style="outline: none; text-decoration:none; color:inherit" href="#17">17</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="18"><a style="outline: none; text-decoration:none; color:inherit" href="#18">18</a>
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ grpcurl --plaintext  -protoset StorageApiService.protoset  localhost:8099 describe
codeflavor.grpcrest.proto.v1.StorageApiService is a service:
service StorageApiService <span style="color:#ff79c6">{</span>
  rpc CreateBucket <span style="color:#ff79c6">(</span> .codeflavor.grpcrest.proto.v1.CreateBucketRequest <span style="color:#ff79c6">)</span> returns <span style="color:#ff79c6">(</span> .codeflavor.grpcrest.proto.v1.CreateBucketResponse <span style="color:#ff79c6">)</span> <span style="color:#ff79c6">{</span>
    option <span style="color:#ff79c6">(</span>.google.api.http<span style="color:#ff79c6">)</span> <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">{</span> post:<span style="color:#f1fa8c">&#34;/v1/buckets&#34;</span> body:<span style="color:#f1fa8c">&#34;*&#34;</span> response_body:<span style="color:#f1fa8c">&#34;bucket&#34;</span>  <span style="color:#ff79c6">}</span>;
  <span style="color:#ff79c6">}</span>
  rpc GetBuckets <span style="color:#ff79c6">(</span> .codeflavor.grpcrest.proto.v1.GetBucketsRequest <span style="color:#ff79c6">)</span> returns <span style="color:#ff79c6">(</span> .codeflavor.grpcrest.proto.v1.GetBucketsResponse <span style="color:#ff79c6">)</span> <span style="color:#ff79c6">{</span>
    option <span style="color:#ff79c6">(</span>.google.api.http<span style="color:#ff79c6">)</span> <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">{</span> get:<span style="color:#f1fa8c">&#34;/v1/buckets&#34;</span>  <span style="color:#ff79c6">}</span>;
  <span style="color:#ff79c6">}</span>
  rpc GetObject <span style="color:#ff79c6">(</span> .codeflavor.grpcrest.proto.v1.GetObjectRequest <span style="color:#ff79c6">)</span> returns <span style="color:#ff79c6">(</span> .codeflavor.grpcrest.proto.v1.GetObjectResponse <span style="color:#ff79c6">)</span> <span style="color:#ff79c6">{</span>
    option <span style="color:#ff79c6">(</span>.google.api.http<span style="color:#ff79c6">)</span> <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">{</span> get:<span style="color:#f1fa8c">&#34;/v1/buckets/{bucket}/objects/*&#34;</span>  <span style="color:#ff79c6">}</span>;
  <span style="color:#ff79c6">}</span>
  rpc GetObjects <span style="color:#ff79c6">(</span> .codeflavor.grpcrest.proto.v1.GetObjectsRequest <span style="color:#ff79c6">)</span> returns <span style="color:#ff79c6">(</span> .codeflavor.grpcrest.proto.v1.GetObjectsResponse <span style="color:#ff79c6">)</span> <span style="color:#ff79c6">{</span>
    option <span style="color:#ff79c6">(</span>.google.api.http<span style="color:#ff79c6">)</span> <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">{</span> get:<span style="color:#f1fa8c">&#34;/v1/buckets/{bucket}/objects&#34;</span>  <span style="color:#ff79c6">}</span>;
  <span style="color:#ff79c6">}</span>
  rpc GetResult <span style="color:#ff79c6">(</span> .codeflavor.grpcrest.proto.v1.GetResultRequest <span style="color:#ff79c6">)</span> returns <span style="color:#ff79c6">(</span> stream .codeflavor.grpcrest.proto.v1.GetResultResponse <span style="color:#ff79c6">)</span> <span style="color:#ff79c6">{</span>
    option <span style="color:#ff79c6">(</span>.google.api.http<span style="color:#ff79c6">)</span> <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">{</span> get:<span style="color:#f1fa8c">&#34;/v1/results&#34;</span>  <span style="color:#ff79c6">}</span>;
  <span style="color:#ff79c6">}</span>
<span style="color:#ff79c6">}</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="debugging">Debugging<a href="#debugging" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h4>
<p>Exporting <code>GODEBUG=http2debug=2</code> locally, in the container or in the k8s pod where the grpc server instance
is currently running is a godsend for troubleshooting problems with incoming requests and also checking if
you requests are actually hitting the service instance.</p>
<p>From the CLI, as mentioned above</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="0"><a style="outline: none; text-decoration:none; color:inherit" href="#0"> 0</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="1"><a style="outline: none; text-decoration:none; color:inherit" href="#1"> 1</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="2"><a style="outline: none; text-decoration:none; color:inherit" href="#2"> 2</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="3"><a style="outline: none; text-decoration:none; color:inherit" href="#3"> 3</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="4"><a style="outline: none; text-decoration:none; color:inherit" href="#4"> 4</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="5"><a style="outline: none; text-decoration:none; color:inherit" href="#5"> 5</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="6"><a style="outline: none; text-decoration:none; color:inherit" href="#6"> 6</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="7"><a style="outline: none; text-decoration:none; color:inherit" href="#7"> 7</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="8"><a style="outline: none; text-decoration:none; color:inherit" href="#8"> 8</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="9"><a style="outline: none; text-decoration:none; color:inherit" href="#9"> 9</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="10"><a style="outline: none; text-decoration:none; color:inherit" href="#10">10</a>
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">grpcurl --plaintext  -protoset StorageApiService.protoset  localhost:8099 codeflavor.grpcrest.proto.v1.StorageApiService.GetBuckets
<span style="color:#ff79c6">{</span>
  <span style="color:#f1fa8c">&#34;buckets&#34;</span>: <span style="color:#ff79c6">[</span>
    <span style="color:#ff79c6">{</span>
      <span style="color:#f1fa8c">&#34;name&#34;</span>: <span style="color:#f1fa8c">&#34;bucket1&#34;</span>
    <span style="color:#ff79c6">}</span>,
    <span style="color:#ff79c6">{</span>
      <span style="color:#f1fa8c">&#34;name&#34;</span>: <span style="color:#f1fa8c">&#34;bucket2&#34;</span>
    <span style="color:#ff79c6">}</span>
  <span style="color:#ff79c6">]</span>
<span style="color:#ff79c6">}</span>
</code></pre></td></tr></table>
</div>
</div><p>STDOUT of the gRPC server (alternatively this shows up in your container logs)</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="0"><a style="outline: none; text-decoration:none; color:inherit" href="#0"> 0</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="1"><a style="outline: none; text-decoration:none; color:inherit" href="#1"> 1</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="2"><a style="outline: none; text-decoration:none; color:inherit" href="#2"> 2</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="3"><a style="outline: none; text-decoration:none; color:inherit" href="#3"> 3</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="4"><a style="outline: none; text-decoration:none; color:inherit" href="#4"> 4</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="5"><a style="outline: none; text-decoration:none; color:inherit" href="#5"> 5</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="6"><a style="outline: none; text-decoration:none; color:inherit" href="#6"> 6</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="7"><a style="outline: none; text-decoration:none; color:inherit" href="#7"> 7</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="8"><a style="outline: none; text-decoration:none; color:inherit" href="#8"> 8</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="9"><a style="outline: none; text-decoration:none; color:inherit" href="#9"> 9</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="10"><a style="outline: none; text-decoration:none; color:inherit" href="#10">10</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="11"><a style="outline: none; text-decoration:none; color:inherit" href="#11">11</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="12"><a style="outline: none; text-decoration:none; color:inherit" href="#12">12</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="13"><a style="outline: none; text-decoration:none; color:inherit" href="#13">13</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="14"><a style="outline: none; text-decoration:none; color:inherit" href="#14">14</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="15"><a style="outline: none; text-decoration:none; color:inherit" href="#15">15</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="16"><a style="outline: none; text-decoration:none; color:inherit" href="#16">16</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="17"><a style="outline: none; text-decoration:none; color:inherit" href="#17">17</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="18"><a style="outline: none; text-decoration:none; color:inherit" href="#18">18</a>
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">2020/12/13 16:39:22 http2: Framer 0xc0003341c0: <span style="color:#8be9fd;font-style:italic">read</span> HEADERS <span style="color:#8be9fd;font-style:italic">flags</span><span style="color:#ff79c6">=</span>END_HEADERS <span style="color:#8be9fd;font-style:italic">stream</span><span style="color:#ff79c6">=</span><span style="color:#bd93f9">1</span> <span style="color:#8be9fd;font-style:italic">len</span><span style="color:#ff79c6">=</span><span style="color:#bd93f9">93</span>
2020/12/13 16:39:22 http2: decoded hpack field header field <span style="color:#f1fa8c">&#34;:method&#34;</span> <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#34;POST&#34;</span>
2020/12/13 16:39:22 http2: decoded hpack field header field <span style="color:#f1fa8c">&#34;:scheme&#34;</span> <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#34;http&#34;</span>
2020/12/13 16:39:22 http2: decoded hpack field header field <span style="color:#f1fa8c">&#34;:path&#34;</span> <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#34;/codeflavor.grpcrest.proto.v1.StorageApiService/GetBuckets&#34;</span>
2020/12/13 16:39:22 http2: decoded hpack field header field <span style="color:#f1fa8c">&#34;:authority&#34;</span> <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#34;localhost:8099&#34;</span>
2020/12/13 16:39:22 http2: decoded hpack field header field <span style="color:#f1fa8c">&#34;content-type&#34;</span> <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#34;application/grpc&#34;</span>
2020/12/13 16:39:22 http2: decoded hpack field header field <span style="color:#f1fa8c">&#34;user-agent&#34;</span> <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#34;grpc-go/1.30.0&#34;</span>
2020/12/13 16:39:22 http2: decoded hpack field header field <span style="color:#f1fa8c">&#34;te&#34;</span> <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#34;trailers&#34;</span>
2020/12/13 16:39:22 http2: Framer 0xc0003341c0: <span style="color:#8be9fd;font-style:italic">read</span> DATA <span style="color:#8be9fd;font-style:italic">flags</span><span style="color:#ff79c6">=</span>END_STREAM <span style="color:#8be9fd;font-style:italic">stream</span><span style="color:#ff79c6">=</span><span style="color:#bd93f9">1</span> <span style="color:#8be9fd;font-style:italic">len</span><span style="color:#ff79c6">=</span><span style="color:#bd93f9">5</span> <span style="color:#8be9fd;font-style:italic">data</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;\x00\x00\x00\x00\x00&#34;</span>
2020/12/13 16:39:22 http2: Framer 0xc0003341c0: wrote WINDOW_UPDATE <span style="color:#8be9fd;font-style:italic">len</span><span style="color:#ff79c6">=</span><span style="color:#bd93f9">4</span> <span style="color:#ff79c6">(</span>conn<span style="color:#ff79c6">)</span> <span style="color:#8be9fd;font-style:italic">incr</span><span style="color:#ff79c6">=</span><span style="color:#bd93f9">5</span>
2020/12/13 16:39:22 http2: Framer 0xc0003341c0: wrote PING <span style="color:#8be9fd;font-style:italic">len</span><span style="color:#ff79c6">=</span><span style="color:#bd93f9">8</span> <span style="color:#8be9fd;font-style:italic">ping</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;\x02\x04\x10\x10\t\x0e\a\a&#34;</span>
2020/12/13 16:39:22 http2: Framer 0xc0003341c0: <span style="color:#8be9fd;font-style:italic">read</span> PING <span style="color:#8be9fd;font-style:italic">flags</span><span style="color:#ff79c6">=</span>ACK <span style="color:#8be9fd;font-style:italic">len</span><span style="color:#ff79c6">=</span><span style="color:#bd93f9">8</span> <span style="color:#8be9fd;font-style:italic">ping</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;\x02\x04\x10\x10\t\x0e\a\a&#34;</span>
&amp;v1.GetBucketsRequest<span style="color:#ff79c6">{</span>state:impl.MessageState<span style="color:#ff79c6">{</span>NoUnkeyedLiterals:pragma.NoUnkeyedLiterals<span style="color:#ff79c6">{}</span>, DoNotCompare:pragma.DoNotCompare<span style="color:#ff79c6">{}</span>, DoNotCopy:pragma.DoNotCopy<span style="color:#ff79c6">{}</span>, atomicMessageInfo:<span style="color:#ff79c6">(</span>*impl.MessageInfo<span style="color:#ff79c6">)(</span>0xc0002b0138<span style="color:#ff79c6">)}</span>, sizeCache:0, unknownFields:<span style="color:#ff79c6">[]</span>uint8<span style="color:#ff79c6">(</span>nil<span style="color:#ff79c6">)</span>, Name:<span style="color:#f1fa8c">&#34;&#34;</span><span style="color:#ff79c6">}</span>
2020/12/13 16:39:22 http2: Framer 0xc0003341c0: wrote HEADERS <span style="color:#8be9fd;font-style:italic">flags</span><span style="color:#ff79c6">=</span>END_HEADERS <span style="color:#8be9fd;font-style:italic">stream</span><span style="color:#ff79c6">=</span><span style="color:#bd93f9">1</span> <span style="color:#8be9fd;font-style:italic">len</span><span style="color:#ff79c6">=</span><span style="color:#bd93f9">14</span>
2020/12/13 16:39:22 http2: Framer 0xc0003341c0: wrote DATA <span style="color:#8be9fd;font-style:italic">stream</span><span style="color:#ff79c6">=</span><span style="color:#bd93f9">1</span> <span style="color:#8be9fd;font-style:italic">len</span><span style="color:#ff79c6">=</span><span style="color:#bd93f9">27</span> <span style="color:#8be9fd;font-style:italic">data</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;\x00\x00\x00\x00\x16\n\t\n\abucket1\n\t\n\abucket2&#34;</span>
2020/12/13 16:39:22 http2: Framer 0xc0003341c0: wrote HEADERS <span style="color:#8be9fd;font-style:italic">flags</span><span style="color:#ff79c6">=</span>END_STREAM|END_HEADERS <span style="color:#8be9fd;font-style:italic">stream</span><span style="color:#ff79c6">=</span><span style="color:#bd93f9">1</span> <span style="color:#8be9fd;font-style:italic">len</span><span style="color:#ff79c6">=</span><span style="color:#bd93f9">24</span>
2020/12/13 16:39:22 http2: Framer 0xc0003341c0: <span style="color:#8be9fd;font-style:italic">read</span> WINDOW_UPDATE <span style="color:#8be9fd;font-style:italic">len</span><span style="color:#ff79c6">=</span><span style="color:#bd93f9">4</span> <span style="color:#ff79c6">(</span>conn<span style="color:#ff79c6">)</span> <span style="color:#8be9fd;font-style:italic">incr</span><span style="color:#ff79c6">=</span><span style="color:#bd93f9">27</span>
2020/12/13 16:39:22 http2: Framer 0xc0003341c0: <span style="color:#8be9fd;font-style:italic">read</span> PING <span style="color:#8be9fd;font-style:italic">len</span><span style="color:#ff79c6">=</span><span style="color:#bd93f9">8</span> <span style="color:#8be9fd;font-style:italic">ping</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;\x02\x04\x10\x10\t\x0e\a\a&#34;</span>
2020/12/13 16:39:22 http2: Framer 0xc0003341c0: wrote PING <span style="color:#8be9fd;font-style:italic">flags</span><span style="color:#ff79c6">=</span>ACK <span style="color:#8be9fd;font-style:italic">len</span><span style="color:#ff79c6">=</span><span style="color:#bd93f9">8</span> <span style="color:#8be9fd;font-style:italic">ping</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;\x02\x04\x10\x10\t\x0e\a\a&#34;</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="grpc-access-over-k8s-nginx-ingress">gRPC access over k8s nginx ingress<a href="#grpc-access-over-k8s-nginx-ingress" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<p>To expose a gRPC service for company wide use there a few options.</p>
<h4 id="loadbalancer-service-type">LoadBalancer service type<a href="#loadbalancer-service-type" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h4>
<p>If you&rsquo;re in a public cloud environment you can expose the service via the service type LoadBalancer and
you&rsquo;re pretty much done.</p>
<p>If you&rsquo;re in a private cloud and have no F5 Load balancer, you can use <a href="https://metallb.universe.tf/">metallb</a>
and do the exact same thing as above.</p>
<h4 id="nginx-k8s-ingress">NGINX k8s Ingress<a href="#nginx-k8s-ingress" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h4>
<p><strong>NOTE:</strong> This example disregards more advanced ingresses and gateways such as <a href="https://istio.io/latest/">Istio</a>,
<a href="https://doc.traefik.io/traefik/user-guides/grpc/">Traekif</a> or
<a href="https://www.haproxy.com/products/haproxy-enterprise-kubernetes-ingress-controller/">HAProxy</a> and only addresses
a stadard <a href="https://www.nginx.com/products/nginx-ingress-controller/">NGINX ingress controller</a>.</p>
<p>If none of these are viable options to you or you prefer that your gRPC service is exposed via a URL rather than
an IP address, then you can make the kubernetes ingress forward gRPC requests to the service by adding a simple
annotation to your ingress.</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="0"><a style="outline: none; text-decoration:none; color:inherit" href="#0"> 0</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="1"><a style="outline: none; text-decoration:none; color:inherit" href="#1"> 1</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="2"><a style="outline: none; text-decoration:none; color:inherit" href="#2"> 2</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="3"><a style="outline: none; text-decoration:none; color:inherit" href="#3"> 3</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="4"><a style="outline: none; text-decoration:none; color:inherit" href="#4"> 4</a>
</span><span style="display:block;width:100%;background-color:#3d3f4a"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="5"><a style="outline: none; text-decoration:none; color:inherit" href="#5"> 5</a>
</span></span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="6"><a style="outline: none; text-decoration:none; color:inherit" href="#6"> 6</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="7"><a style="outline: none; text-decoration:none; color:inherit" href="#7"> 7</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="8"><a style="outline: none; text-decoration:none; color:inherit" href="#8"> 8</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="9"><a style="outline: none; text-decoration:none; color:inherit" href="#9"> 9</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="10"><a style="outline: none; text-decoration:none; color:inherit" href="#10">10</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="11"><a style="outline: none; text-decoration:none; color:inherit" href="#11">11</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="12"><a style="outline: none; text-decoration:none; color:inherit" href="#12">12</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="13"><a style="outline: none; text-decoration:none; color:inherit" href="#13">13</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="14"><a style="outline: none; text-decoration:none; color:inherit" href="#14">14</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="15"><a style="outline: none; text-decoration:none; color:inherit" href="#15">15</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="16"><a style="outline: none; text-decoration:none; color:inherit" href="#16">16</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="17"><a style="outline: none; text-decoration:none; color:inherit" href="#17">17</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="18"><a style="outline: none; text-decoration:none; color:inherit" href="#18">18</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="19"><a style="outline: none; text-decoration:none; color:inherit" href="#19">19</a>
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#ff79c6">apiVersion</span>: networking.k8s.io/v1beta1
<span style="color:#ff79c6">kind</span>: Ingress
<span style="color:#ff79c6">metadata</span>:
  <span style="color:#ff79c6">annotations</span>:
    <span style="color:#ff79c6">kubernetes.io/ingress.class</span>: nginx
<span style="display:block;width:100%;background-color:#3d3f4a">    <span style="color:#ff79c6">nginx.ingress.kubernetes.io/backend-protocol</span>: <span style="color:#f1fa8c">&#34;GRPC&#34;</span>
</span>  <span style="color:#ff79c6">labels</span>:
    <span style="color:#ff79c6">backend-protocol</span>: grpc
    <span style="color:#ff79c6">environment</span>: production
    <span style="color:#ff79c6">project</span>: myproject
  <span style="color:#ff79c6">name</span>: myingress
  <span style="color:#ff79c6">namespace</span>: mynamespace-prod
<span style="color:#ff79c6">spec</span>:
  <span style="color:#ff79c6">rules</span>:
  - <span style="color:#ff79c6">host</span>: mygrpcservice.k8s.example.com
    <span style="color:#ff79c6">http</span>:
      <span style="color:#ff79c6">paths</span>:
      - <span style="color:#ff79c6">backend</span>:
          <span style="color:#ff79c6">serviceName</span>: grpcservice
          <span style="color:#ff79c6">servicePort</span>: grpcport</code></pre></td></tr></table>
</div>
</div>
<p>The catch here is that this ingress should have https. If you do automatic https at the nginx controller level or
you have a tls section in the ingress definition above, that is up to you. <strong>gRPC over http doesn&rsquo;t work</strong>.
Another thing to keep in mind is that your nginx ingress controller needs to be <code>v0.30</code> or above.</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="0"><a style="outline: none; text-decoration:none; color:inherit" href="#0"> 0</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="1"><a style="outline: none; text-decoration:none; color:inherit" href="#1"> 1</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="2"><a style="outline: none; text-decoration:none; color:inherit" href="#2"> 2</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="3"><a style="outline: none; text-decoration:none; color:inherit" href="#3"> 3</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="4"><a style="outline: none; text-decoration:none; color:inherit" href="#4"> 4</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="5"><a style="outline: none; text-decoration:none; color:inherit" href="#5"> 5</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="6"><a style="outline: none; text-decoration:none; color:inherit" href="#6"> 6</a>
</span><span style="display:block;width:100%;background-color:#3d3f4a"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="7"><a style="outline: none; text-decoration:none; color:inherit" href="#7"> 7</a>
</span></span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="8"><a style="outline: none; text-decoration:none; color:inherit" href="#8"> 8</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="9"><a style="outline: none; text-decoration:none; color:inherit" href="#9"> 9</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="10"><a style="outline: none; text-decoration:none; color:inherit" href="#10">10</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="11"><a style="outline: none; text-decoration:none; color:inherit" href="#11">11</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="12"><a style="outline: none; text-decoration:none; color:inherit" href="#12">12</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="13"><a style="outline: none; text-decoration:none; color:inherit" href="#13">13</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="14"><a style="outline: none; text-decoration:none; color:inherit" href="#14">14</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="15"><a style="outline: none; text-decoration:none; color:inherit" href="#15">15</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="16"><a style="outline: none; text-decoration:none; color:inherit" href="#16">16</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="17"><a style="outline: none; text-decoration:none; color:inherit" href="#17">17</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="18"><a style="outline: none; text-decoration:none; color:inherit" href="#18">18</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="19"><a style="outline: none; text-decoration:none; color:inherit" href="#19">19</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="20"><a style="outline: none; text-decoration:none; color:inherit" href="#20">20</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="21"><a style="outline: none; text-decoration:none; color:inherit" href="#21">21</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="22"><a style="outline: none; text-decoration:none; color:inherit" href="#22">22</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="23"><a style="outline: none; text-decoration:none; color:inherit" href="#23">23</a>
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#ff79c6">import</span> (
    <span style="color:#f1fa8c">&#34;google.golang.org/grpc&#34;</span>
    grpcCreds <span style="color:#f1fa8c">&#34;google.golang.org/grpc/credentials&#34;</span>
)

<span style="color:#8be9fd;font-style:italic">func</span> <span style="color:#50fa7b">main</span>() {
    <span style="color:#6272a4">// this is the (https) address exposed by the kubernetes ingress.
</span><span style="display:block;width:100%;background-color:#3d3f4a"><span style="color:#6272a4"></span>    apiAddress <span style="color:#ff79c6">:=</span> <span style="color:#f1fa8c">&#34;mygrpcservice.k8s.example.com:443&#34;</span>
</span>    config <span style="color:#ff79c6">:=</span> <span style="color:#ff79c6">&amp;</span>tls.Config{
        <span style="color:#6272a4">// This is here only to make it work with self signed certs.
</span><span style="color:#6272a4"></span>        InsecureSkipVerify: <span style="color:#ff79c6">true</span>,
        NextProtos:         []<span style="color:#8be9fd">string</span>{<span style="color:#f1fa8c">&#34;h2&#34;</span>},
    }
    creds <span style="color:#ff79c6">:=</span> grpcCreds.<span style="color:#50fa7b">NewTLS</span>(config)
    conn, err <span style="color:#ff79c6">:=</span> grpc.<span style="color:#50fa7b">Dial</span>(
            apiAddress,
            grpc.<span style="color:#50fa7b">WithTransportCredentials</span>(creds),
    )
    <span style="color:#ff79c6">if</span> err <span style="color:#ff79c6">!=</span> <span style="color:#ff79c6">nil</span> {
        <span style="color:#8be9fd;font-style:italic">panic</span>(err)
    }
    <span style="color:#ff79c6">defer</span> conn.<span style="color:#50fa7b">Close</span>()
    <span style="color:#6272a4">//conn can now be used to dial to the gRPC server.
</span><span style="color:#6272a4"></span>}
</code></pre></td></tr></table>
</div>
</div>
<p>In conclusion, i think that these things would help anyone in their quest of building resilient and
intuitive APIs but also help developers to understand better how to explore, debug and troubleshoot
gRPC APIs.</p>
<p>In the next posts i will also discuss <a href="https://github.com/grpc/grpc-web">grpc-web</a> for enabling a frontend
app to talk to a gRPC server, <a href="https://github.com/grpc-ecosystem/grpc-gateway">grpc-gateway</a> for
transcoding REST API calls to gRPC calls and also documentating through proto annotations the REST API
endpoints with the <a href="https://swagger.io/specification/v2/">OpenAPIv2 spec</a> and
<a href="https://github.com/grpc-ecosystem/go-grpc-middleware">gRPC interceptors</a> as gRPC middleware.</p>

      </div></div>

  

  

</div>

  </div>

  
    <footer class="footer">
  <div class="footer__inner">
    
      <div class="copyright">
        <span>© 2020 Powered by <a href="http://gohugo.io">Hugo</a></span>
    
        <span>:: Theme made by <a href="https://twitter.com/panr">panr</a></span>
      </div>
  </div>
</footer>

<script src="http://victor.cloudflavor.io/assets/main.js"></script>
<script src="http://victor.cloudflavor.io/assets/prism.js"></script>







  
</div>

</body>
</html>
